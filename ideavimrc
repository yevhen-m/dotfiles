let mapleader=","

""" Plugins  --------------------------------
set matchit
set surround
set nerdtree
set easymotion
set multiple-cursors
set commentary
set argtextobj
set textobj-entire
set textobj-indent
set vim-paragraph-motion
set ReplaceWithRegister
set highlightedyank
set exchange
set quickscope

""" Plugin settings -------------------------
let g:argtextobj_pairs="[:],(:),<:>"
let g:qs_highlight_on_keys = ['f', 'F', 't', 'T']

""" Common settings -------------------------
set clipboard+=unnamed
set clipboard+=ideaput
set showmode
set scrolloff=5
set sidescrolloff=5
set incsearch
set visualbell
set incsearch
set ignorecase
set smartcase
set hlsearch
set number

""" Idea specific settings ------------------
set ideajoin
set ideastatusicon=enabled
set idearefactormode=keep

""" Mappings --------------------------------
" To copy text to the end-of-line, press Y.
" This mapping sets up Y to be consistent with
" the C and D operators, which act from the cursor
" to the end of the line. The default behavior of Y
" is to yank the whole line.
nnoremap Y y$

nnoremap 0 ^
nnoremap ^ 0

imap <C-y> <Action>(EditorChooseLookupItem)
imap <C-/> <Action>(copilot.applyInlays)

inoremap <C-a> <C-o>^
inoremap <C-e> <End>
inoremap <C-f> <Right>
cnoremap <C-f> <Right>
inoremap <C-b> <Left>
cnoremap <C-b> <Left>
inoremap <C-d> <Del>
cnoremap <C-d> <Del>
inoremap <C-k> <C-o>D<Right>

nnoremap <Space> :nohlsearch<CR>
inoremap <Esc> <Esc>:nohlsearch<cr>l

" EasyMotion mappings
let g:EasyMotion_do_mapping = 0
nmap s         <Plug>(easymotion-f2)
xmap s         <Plug>(easymotion-f2)
omap s         <Plug>(easymotion-f2)
nmap S         <Plug>(easymotion-F2)
xmap S         <Plug>(easymotion-F2)
omap S         <Plug>(easymotion-F2)

map gd <Action>(GotoDeclaration)
map gD <Action>(GotoTypeDeclaration)
map <leader>rn <Action>(RenameElement)
map <leader>u <Action>(FindUsages)
map ]q <Action>(NextOccurence)
map [q <Action>(PreviousOccurence)

map <C-r> <Action>(Rerun)
nnoremap U <C-r>


" When in normal mode and I hit Enter, then save file please
nmap <CR> :action ReformatCode<CR> :write<CR>

" Remap multiple-cursors shortcuts to match terryma/vim-multiple-cursors
nmap <C-g> <Plug>NextWholeOccurrence
xmap <C-g> <Plug>NextWholeOccurrence
nmap g<C-g> <Plug>NextOccurrence
xmap g<C-g> <Plug>NextOccurrence
xmap <C-x> <Plug>SkipOccurrence
xmap <C-p> <Plug>RemoveOccurrence

" Window navigation
nnoremap <C-w><c-\> :action SplitVertically<CR>
nnoremap <C-w>\ :action SplitVertically<CR>
nnoremap <C-w>\' :action SplitVertically<CR>
nnoremap <C-w><c--> :action SplitHorizontally<CR>
nnoremap <C-w>- :action SplitHorizontally<CR>
nnoremap <C-w>\" :action SplitHorizontally<CR>
nnoremap <C-w><c-m> :action MoveEditorToOppositeTabGroup<CR>
nnoremap <C-w><c-=> :action Unsplit<CR>
nnoremap <C-w>o :action HideAllWindows<CR>
nnoremap <C-w><C-o> :action HideAllWindows<CR>
sethandler <c-j> a:vim
sethandler <c-k> a:vim
nnoremap <c-h> <c-w>h
nnoremap <c-l> <c-w>l
nnoremap <c-j> <c-w>j
nnoremap <c-k> <c-w>k

" While in visual mode
" will delete what is currently highlighted and replace it
" with what is in the register BUT it will YANK (delete) it
" to a VOID register. Meaning I still have what I originally had
" when I pasted. I don't loose the previous thing I YANKED!
vnoremap gp "_dP

vnoremap < <gv
vnoremap > >gv

nmap ]e :action GotoNextError<CR>
nmap [e :action GotoPreviousError<CR>

nmap ]h <Action>(VcsShowNextChangeMarker)
nmap [h <Action>(VcsShowPrevChangeMarker)

" Marks
nnoremap M `
nmap md <Action>(ToggleBookmark)

" Focus project window
nmap - <Action>(ActivateProjectToolWindow)

" Insert empty lines around the current line
nnoremap [<Space> O<Esc>j
nnoremap ]<Space> o<Esc>k

" Move in insert mode
nnoremap <A-k> :m .-2<CR>==
nnoremap <A-j> :m .+1<CR>==
inoremap <A-k> <Esc>:m .-2<CR>==gi
inoremap <A-j> <Esc>:m .+1<CR>==gi
vnoremap <A-j> :m '>+1<CR>gv=gv
vnoremap <A-k> :m '<-2<CR>gv=gv

" Save
nnoremap <leader><leader> :write<CR>

" Switch buffers
nnoremap H :tabprevious<CR>
nnoremap [b :tabprevious<CR>
nnoremap L :tabnext<cr>
nnoremap ]b :tabnext<cr>
nnoremap <leader>bo :action CloseAllEditorsButActive<CR>
nnoremap <leader>bd :bdelete<CR>


" Use backslash to jump to the previous match
nnoremap \\ ,

nmap <C-p> <Action>(GotoFile)
nnoremap <leader>sg :action FindInPath<cr>
nnoremap <leader>s. :action RecentFiles<cr>
nnoremap <leader>ws :action GotoSymbol<cr>

nnoremap g; :action JumpToLastChange<CR>
nnoremap g, :action JumpToNextChange<CR>
